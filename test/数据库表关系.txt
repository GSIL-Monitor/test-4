###
素材相关的表
select * from expert_info where name in('张瑞岭','赵靖平');
120162:张瑞岭
510070:成瘾障碍

120170:赵靖平
510019
学科：精神卫生学
select * from expert_prop_val where PROPID=510019 and EXPERTID=120170;----专家学科
510019:精神卫生学
510070:成瘾障碍

select * from exam_prop_val where name in('成瘾障碍','精神卫生学','传染病学');

select * from exam_icd_prop where name='成瘾障碍';



select * from material_info where id>=3903934;---素材的创建人：     expertname；


SELECT * from material_prop_val where material_id >=3903935;


select material_id from material_prop_val where PROP_ID not in(select epv.PROPID from expert_prop_val epv,expert_info ei where epv.EXPERTID=ei.ID and ei.USERNAME='zhaojingping')


select * from system_account where account_id=21669

select *  from material_info where id>0  and creatorid !=21669 and state = 2  order by id desc limit 0, 20



select *  from material_info where id>0  and creatorid !=21669 and state = 2 
and id not in (select material_id from material_prop_val where PROP_ID  in(select epv.PROPID from expert_prop_val epv,expert_info ei where epv.EXPERTID=ei.ID and ei.USERNAME='zhaojingping'))

 order by id desc limit 0, 20


select material_id,PROP_ID from material_prop_val where PROP_ID  in(select epv.PROPID from expert_prop_val epv,expert_info ei where epv.EXPERTID=ei.ID and ei.USERNAME='zhaojingping')



select *  from material_info where id=3303909


select  *  from material_prop_val where material_id=3303909

select  * from expert_prop_val where  EXPERTID=120170;


select * from expert_info where name in('张瑞岭','赵靖平');


select * from system_account where account_id=21669 and ACCOUNT_NAME='zhaojingping';

select * from system_user where id=21669;

select * from system_experts  where user_id=21669;


select PROPID from expert_prop_val where PROPID=510019 and EXPERTID=(select id from expert_info where USERNAME='zhaojingping');

select epv.PROPID from expert_prop_val epv,expert_info ei where epv.EXPERTID=ei.ID and ei.USERNAME='zhaojingping'


###

题库对应的表
SELECT DISTINCT
	t.id,
	t.question_label_id,
	t.parent_id,
	t.content,
	t.state,
	t.grade,
	t.differ,
	t.analyse,
	t.source,
	t.seq,
	DATE_FORMAT(
		t.create_date,
		'%Y-%m-%d %H:%i:%S'
	) AS create_date,
	t.author,
	t.checker,
	DATE_FORMAT(
		t.online_date,
		'%Y-%m-%d %H:%i:%S'
	) AS online_date,
	t.surname,
	t.opinion
FROM
	exam_question t,
	exam_question_type t1,
	exam_sys_quest_type_quest t2
WHERE
	t.id = t2.question_id
AND t1.id = t2.sub_type_id
AND t.parent_id = 0
AND t2.state = 1

and t.AUTHOR!='zhaojingping'
AND t.id NOT IN (
	SELECT
		question_id
	FROM
		exam_question_unit
	WHERE
		prop_val_id IN (
			SELECT
				epv.PROPID
			FROM
				expert_prop_val epv,
				expert_info ei
			WHERE
				epv.EXPERTID = ei.ID
			AND ei.USERNAME ='zhaojingping'
		)
)
;
  and t.AUTHOR!=? and t.id not in (select question_id from exam_question_unit where prop_val_id  in(select epv.PROPID from expert_prop_val epv,expert_info ei where epv.EXPERTID=ei.ID and ei.USERNAME=?))

and t.id not in (select question_id from exam_question_unit where prop_val_id  in(select epv.PROPID from expert_prop_val epv,expert_info ei where epv.EXPERTID=ei.ID and ei.USERNAME=?))

select * from exam_question order by id desc;4117889

select * from exam_question_unit where question_id=4117889;


select * from exam_prop_val where id in(510038,510041);


AND t.id NOT IN (
	SELECT
		question_id
	FROM
		exam_question_unit
	WHERE
		prop_val_id IN (
			SELECT
				epv.PROPID
			FROM
				expert_prop_val epv,
				expert_info ei
			WHERE
				epv.EXPERTID = ei.ID
			AND ei.USERNAME ='zhaojingping'
		)
)
###########
病例相关的表

SELECT DISTINCT
			c.*, CONVERT (p.id USING gbk)
		FROM
			CASE_CASE c
		LEFT JOIN CASE_PATIENT p ON c.P_ID = p.ID
		LEFT JOIN CASE_PATIENT_DIAGNOSIS d ON p.ID = d.patientid
		LEFT JOIN CASE_PATIENT_PROP_VAL v ON v.patientid = p.id
		LEFT JOIN CASE_PATIENT_PROP_VAL vv ON vv.patientid = p.id
		LEFT JOIN CASE_PATIENT_PROP_VAL vvv ON vvv.patientid = p.id
		WHERE
			p.ID > 0
		AND c.state != 5
		AND c.P_ID IN (
			SELECT
				patientid
			FROM
				CASE_PATIENT_PROP_VAL
			WHERE
				propID IN (
					SELECT
						epv.PROPID
					FROM
						expert_prop_val epv,
						expert_info ei
					WHERE
						epv.EXPERTID = ei.ID
					AND ei.USERNAME = 'zhaojingping'
				)
		)
		AND c.STATE = '1'
		AND c.creator != 21669
		ORDER BY
			p.id DESC



